<?php /**
 * Generated by the WordPress Meta Box generator
 * at http://jeremyhixon.com/tool/wordpress-meta-box-generator/
 */

function alopex_survey_get_meta( $value ) {
	global $post;
    
	$field = get_post_meta( $post->ID, $value, true );
	if ( isset( $field ) ) {
		return is_array( $field ) ? stripslashes_deep( $field ) : stripslashes( wp_kses_decode_entities( $field ) );
	} else {
		return false;
	}
}

function alopex_survey_add_meta_box() {
	add_meta_box(
		'alopex_survey-alopex-survey',
		__( 'Survey Answers', 'survey_answers' ),
		'alopex_survey_html',
		'alopex_survey',
		'normal',
		'high'
	);
}
//add_action( 'add_meta_boxes', 'alopex_survey_add_meta_box' ); //This is called from register_post_type / register_meta_box_cb 

function alopex_survey_html( $post) {
	wp_nonce_field( '_alopex_survey_nonce', 'alopex_survey_nonce' ); ?>
	<p>The answers to your question</p>

	<p>
		<label for="alopex_survey_answer01_name"><?php _e( 'Answer 01', 'alopex_survey' ); ?></label>
        <input type="text" name="alopex_survey_answer01_name" id="alopex_survey_answer01_name" value="<?php 
        echo (is_edit_page('new')) ? 'Always' : alopex_survey_get_meta('alopex_survey_answer01_name'); 
        ?>">
		
		<label for="alopex_survey_answer01_points"><?php _e( 'Points', 'alopex_survey' ); ?></label>
		<input type="text" name="alopex_survey_answer01_points" id="alopex_survey_answer01_points" value="<?php 
        echo (is_edit_page('new')) ? '5' : alopex_survey_get_meta('alopex_survey_answer01_points'); 
        ?>">
	</p>	<p>
		<label for="alopex_survey_answer02_name"><?php _e( 'Answer 02', 'alopex_survey' ); ?></label>
		<input type="text" name="alopex_survey_answer02_name" id="alopex_survey_answer02_name" value="<?php 
        echo (is_edit_page('new')) ? 'Occasionally' : alopex_survey_get_meta('alopex_survey_answer02_name'); 
        ?>">

		<label for="alopex_survey_answer02_points"><?php _e( 'Points', 'alopex_survey' ); ?></label>
		<input type="text" name="alopex_survey_answer02_points" id="alopex_survey_answer02_points" value="<?php 
        echo (is_edit_page('new')) ? '3' : alopex_survey_get_meta('alopex_survey_answer02_points'); 
        ?>">
	</p>	<p>
		<label for="alopex_survey_answer03_name"><?php _e( 'Answer 03', 'alopex_survey' ); ?></label>
		<input type="text" name="alopex_survey_answer03_name" id="alopex_survey_answer03_name" value="<?php 
        echo (is_edit_page('new')) ? 'Little to Never' : alopex_survey_get_meta('alopex_survey_answer03_name'); 
        ?>">

		<label for="alopex_survey_answer03_points"><?php _e( 'Points', 'alopex_survey' ); ?></label>
		<input type="text" name="alopex_survey_answer03_points" id="alopex_survey_answer03_points" value="<?php 
        echo (is_edit_page('new')) ? '0' : alopex_survey_get_meta('alopex_survey_answer03_points'); 
        ?>">
	</p><?php
}

function alopex_survey_save( $post_id ) {
	if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return;
	if ( ! isset( $_POST['alopex_survey_nonce'] ) || ! wp_verify_nonce( $_POST['alopex_survey_nonce'], '_alopex_survey_nonce' ) ) return;
	if ( ! current_user_can( 'edit_post', $post_id ) ) return;

	if ( isset( $_POST['alopex_survey_answer01_name'] ) )
		update_post_meta( $post_id, 'alopex_survey_answer01_name', esc_attr( $_POST['alopex_survey_answer01_name'] ) );
	if ( isset( $_POST['alopex_survey_answer01_points'] ) )
		update_post_meta( $post_id, 'alopex_survey_answer01_points', esc_attr( $_POST['alopex_survey_answer01_points'] ) );
	if ( isset( $_POST['alopex_survey_answer02_name'] ) )
		update_post_meta( $post_id, 'alopex_survey_answer02_name', esc_attr( $_POST['alopex_survey_answer02_name'] ) );
	if ( isset( $_POST['alopex_survey_answer02_points'] ) )
		update_post_meta( $post_id, 'alopex_survey_answer02_points', esc_attr( $_POST['alopex_survey_answer02_points'] ) );
	if ( isset( $_POST['alopex_survey_answer03_name'] ) )
		update_post_meta( $post_id, 'alopex_survey_answer03_name', esc_attr( $_POST['alopex_survey_answer03_name'] ) );
	if ( isset( $_POST['alopex_survey_answer03_points'] ) )
		update_post_meta( $post_id, 'alopex_survey_answer03_points', esc_attr( $_POST['alopex_survey_answer03_points'] ) );
}
add_action( 'save_post', 'alopex_survey_save' );

/*
	Usage: alopex_survey_get_meta( 'alopex_survey_answer01_name' )
	Usage: alopex_survey_get_meta( 'alopex_survey_answer01_points' )
	Usage: alopex_survey_get_meta( 'alopex_survey_answer02_name' )
	Usage: alopex_survey_get_meta( 'alopex_survey_answer02_points' )
	Usage: alopex_survey_get_meta( 'alopex_survey_answer03_name' )
	Usage: alopex_survey_get_meta( 'alopex_survey_answer03_points' )
*/
